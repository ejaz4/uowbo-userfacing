model Tenant {
  id   String  @id @default(uuid())
  name String
  icon String?

  linkedPlatforms LinkedPlatforms?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model LinkedPlatforms {
  id String @id @default(uuid())

  discordGuild DiscordGuild?

  tenant   Tenant @relation(fields: [tenantId], references: [id])
  tenantId String @unique
}

model DiscordGuild {
  id   String  @id
  name String
  icon String?

  guildMembers DiscordGuildMember[]

  linkedTo   LinkedPlatforms? @relation(fields: [linkedToId], references: [id])
  linkedToId String?          @unique
}

model DiscordGuildMember {
  id String @id @default(uuid())

  discordGuild   DiscordGuild @relation(fields: [discordGuildId], references: [id])
  discordGuildId String

  discord              DiscordAccountLink @relation(fields: [discordAccountLinkId], references: [id])
  discordAccountLinkId String

  messages DiscordGuildMessage[]
  isOwner  Boolean               @default(false)

  joinedAt DateTime @default(now())

  @@unique([discordGuildId, discordAccountLinkId])
}

model DiscordGuildMessage {
  id String @id

  message String?

  mentions        DiscordGuildMessage[] @relation("mention")
  parentMessage   DiscordGuildMessage?  @relation("mention", fields: [parentMessageId], references: [id])
  parentMessageId String?

  user   DiscordGuildMember? @relation(fields: [userId], references: [id])
  userId String?

  attachmentUrl String?

  createdAt DateTime @default(now())
}
